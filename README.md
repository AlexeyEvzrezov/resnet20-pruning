# Обучение ResNet20 на CIFAR10 и реализация Filter-Level Pruning
В настоящей работе реализована архитектура ResNet20 вместе с процедурой обучения на наборе данных CIFAR10 (точность (accuracy) модели - 93.02%), 
а также метод прунинга (filter-level pruning) на полученной обученной модели.

Для реализации прунинга была проведена кластеризация (k-means++) сверток, представляющих отдельные слои. 
Каждая исходная свертка в соответствующем слое заменялась на центроид кластера, к которому она была отнесена, 
при этом прочие представители каждого кластера удалялись.  
С учетом специфической структуры используемой сети (необходимость наличия полного количества каналов, 
чтобы выполнить операцию сложения с "остатком" в каждом блоке) мы применяли прунинг только к первым сверточным слоям каждого блока (BasicBlock). 
Дополнительно, вместо стратегии замены весов на центроиды соответствующих кластеров, мы использовали идею оставить только те веса, 
которые оказались наиболее близки к центроидам своих кластеров (без замены). 
Это позволило улучшить результаты (см. ниже), однако стоит отметить, что наша реализация стратегии замены на центроиды имеет пробелы 
и еще требует существенной доработки, поэтому мы пока не можем позволить себе сделать вполне обоснованные выводы.

## Результаты
На данный момент мы успели коснуться только экспериментов с отдельными слоями.  
Ниже приведены графики со значениями потерь и качества в процессе обучения сети, 
а также графики изменения accuracy в зависимости от количества примененных кластеров (и, соответственно, удаленных фльтров) 
для каждой из реализованных стратегий - с заменой на центроиды и без.  
### Обучение
![resnet20_learning](https://github.com/AlexeyEvzrezov/resnet20-pruning/blob/master/img/resnet20_learning.png)
### Прунинг 1-го блока
![1st_block_pruning](https://github.com/AlexeyEvzrezov/resnet20-pruning/blob/master/img/1st_block_pruning.png)
### Прунинг 2-го блока
![1st_block_pruning](https://github.com/AlexeyEvzrezov/resnet20-pruning/blob/master/img/2nd_block_pruning.png)
### Прунинг 3-го блока
![1st_block_pruning](https://github.com/AlexeyEvzrezov/resnet20-pruning/blob/master/img/3rd_block_pruning.png)

## Некоторые выводы и дальнейшие шаги

